import{u as O,r as N,j as e,f as D,m as w,a as k,C as P,U as $,g as z,b as U,c as f,d as p,e as S,h as E,X as F,z as C}from"./index-B5-U9oIS.js";import{P as R}from"./plus-0vm9Kazn.js";import{M as Y}from"./map-pin-Cj7N8xlk.js";const H=()=>{const{user:l}=O(),[c,g]=N.useState(new Date),[B,m]=N.useState(!1),[x,y]=N.useState(null),j=c.getMonth(),u=c.getYear(),I=((s,t)=>{const a=new Date(t,s,1),d=new Date(t,s+1,0).getDate(),i=a.getDay(),r=[];for(let o=0;o<i;o++)r.push(null);for(let o=1;o<=d;o++)r.push(new Date(t,s,o));return r})(j,u),h=s=>{const t=s.getDay();return S.filter(a=>a.schedule.some(n=>n.dayOfWeek===t))},b=s=>{const t=s.toDateString();return p.filter(a=>a.userId===(l==null?void 0:l.id)&&new Date(a.date).toDateString()===t)},M=s=>{g(s);const t=h(s);t.length>0&&y(t[0].id)},v=(s,t)=>{if(p.find(n=>n.userId===(l==null?void 0:l.id)&&n.lessonId===s&&new Date(n.date).toDateString()===t.toDateString())){C.error("Έχετε ήδη κράτηση για αυτό το μάθημα");return}C.success("Η κράτηση δημιουργήθηκε επιτυχώς!"),m(!1)},T=()=>{g(new Date(u,j-1,1))},L=()=>{g(new Date(u,j+1,1))},W=["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Κρατήσεις Μαθημάτων"}),e.jsx("p",{className:"text-gray-600",children:"Διαχειριστείτε τις κρατήσεις και κλείστε νέα μαθήματα"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"btn-primary flex items-center",children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Νέα Κράτηση"]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Ημερολόγιο"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:T,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("span",{className:"text-lg font-medium text-gray-900",children:[W[j]," ",u]}),e.jsx("button",{onClick:L,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"].map(s=>e.jsx("div",{className:"p-2 text-center text-sm font-medium text-gray-500",children:s},s)),I.map((s,t)=>{if(!s)return e.jsx("div",{className:"p-2"},t);const a=s.toDateString()===c.toDateString(),n=s.toDateString()===new Date().toDateString(),d=h(s),r=b(s).length>0;return e.jsxs("button",{onClick:()=>M(s),className:`
                      p-2 text-left min-h-[80px] border rounded-lg transition-colors relative
                      ${a?"bg-primary-100 border-primary-300 text-primary-900":"hover:bg-gray-50 border-gray-200"}
                      ${n?"ring-2 ring-primary-500":""}
                    `,children:[e.jsx("span",{className:`text-sm font-medium ${n?"text-primary-600":"text-gray-900"}`,children:s.getDate()}),d.length>0&&e.jsxs("div",{className:"mt-1 space-y-1",children:[d.slice(0,2).map(o=>e.jsx("div",{className:"text-xs p-1 rounded bg-blue-100 text-blue-800 truncate",title:o.name,children:o.name},o.id)),d.length>2&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",d.length-2," ακόμα"]})]}),r&&e.jsx("div",{className:"absolute top-1 right-1",children:e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"})})]},t)})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"card",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Μαθήματα για ",D(c)]}),e.jsxs("div",{className:"space-y-3",children:[h(c).map(s=>{const t=w.find(r=>r.id===s.roomId),a=k.find(r=>r.id===s.trainerId),d=b(c).some(r=>r.lessonId===s.id),i=s.schedule.find(r=>r.dayOfWeek===c.getDay());return e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"mt-1 space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"h-3 w-3 mr-1"}),i==null?void 0:i.startTime," - ",i==null?void 0:i.endTime]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-3 w-3 mr-1"}),t==null?void 0:t.name]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx($,{className:"h-3 w-3 mr-1"}),a!=null&&a.bio?a.bio.split(" ").slice(0,3).join(" ")+"...":"Trainer"]})]}),e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx("span",{className:"badge badge-info",children:z(s.category)}),e.jsx("span",{className:"badge badge-info",children:U(s.difficulty)})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-primary-600",children:[s.credits," πιστώση"]}),d?e.jsx("span",{className:"badge badge-success text-xs",children:"Κρατημένο"}):e.jsx("button",{onClick:()=>v(s.id,c),className:"btn-primary text-xs py-1 px-2",children:"Κράτηση"})]})]})},s.id)}),h(c).length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(f,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{children:"Δεν υπάρχουν διαθέσιμα μαθήματα για αυτή την ημερομηνία"})]})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Οι Κρατήσεις μου"}),e.jsxs("div",{className:"space-y-3",children:[p.filter(s=>s.userId===(l==null?void 0:l.id)).sort((s,t)=>new Date(s.date).getTime()-new Date(t.date).getTime()).map(s=>{var d;const t=S.find(i=>i.id===s.lessonId),a=w.find(i=>i.id===(t==null?void 0:t.roomId)),n=k.find(i=>i.id===(t==null?void 0:t.trainerId));return t?e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-2 bg-primary-100 rounded-lg",children:e.jsx(f,{className:"h-5 w-5 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[D(s.date)," • ",(d=t.schedule[0])==null?void 0:d.startTime," • ",a==null?void 0:a.name]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Προπονητής: ",n!=null&&n.bio?n.bio.split(" ").slice(0,3).join(" ")+"...":"Trainer"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:`badge ${s.status==="confirmed"?"badge-success":s.status==="cancelled"?"badge-error":s.status==="completed"?"badge-info":"badge-warning"}`,children:E(s.status)}),s.status==="confirmed"&&e.jsx("button",{className:"btn-secondary text-xs py-1 px-2",children:"Ακύρωση"})]})]},s.id):null}),p.filter(s=>s.userId===(l==null?void 0:l.id)).length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(f,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{children:"Δεν έχετε κρατήσεις ακόμα"}),e.jsx("button",{onClick:()=>m(!0),className:"btn-primary mt-3",children:"Κράτηση Πρώτου Μαθήματος"})]})]})]}),B&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Νέα Κράτηση"}),e.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(F,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Ημερομηνία"}),e.jsx("input",{type:"date",className:"input-field",value:c.toISOString().split("T")[0],onChange:s=>g(new Date(s.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Μάθημα"}),e.jsxs("select",{className:"input-field",value:x||"",onChange:s=>y(s.target.value),children:[e.jsx("option",{value:"",children:"Επιλέξτε μάθημα"}),h(c).map(s=>{var t;return e.jsxs("option",{value:s.id,children:[s.name," (",(t=s.schedule[0])==null?void 0:t.startTime,")"]},s.id)})]})]}),x&&e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Κόστος: 1 πιστώση"})})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>m(!1),className:"btn-secondary flex-1",children:"Ακύρωση"}),e.jsx("button",{onClick:()=>{x&&v(x,c)},disabled:!x,className:"btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:"Επιβεβαίωση Κράτησης"})]})]})})]})};export{H as default};
