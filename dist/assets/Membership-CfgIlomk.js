const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B5-U9oIS.js","assets/index-CAhEazQ-.css"])))=>i.map(i=>d[i]);
import{u as q,r as m,i as z,k as B,j as e,l as j,n as g,f as p,o,p as P,q as N,Z as K,z as O,_ as D}from"./index-B5-U9oIS.js";import{P as V}from"./plus-0vm9Kazn.js";import{C as S}from"./circle-check-big-BKWgscB5.js";import{T as L}from"./trending-up-p3383uTI.js";import{A as Z}from"./award-CO5PU1t_.js";const Q=()=>{var C;const{user:l}=q(),[T,n]=m.useState(!1),[x,u]=m.useState(null),[I,h]=m.useState(!1),[b,y]=m.useState(""),[v,d]=m.useState(""),r=z.find(s=>s.userId===(l==null?void 0:l.id)),w=B.filter(s=>s.userId===(l==null?void 0:l.id)),M=s=>{u(s),n(!0)},k=()=>{x&&(O.success("Η πληρωμή δημιουργήθηκε επιτυχώς! Εκκρεμεί έγκριση από διαχειριστή."),n(!1),u(null))},E=()=>{h(!0),y(""),d("")},_=async()=>{const s=b.trim();if(!s){d("Παρακαλώ εισάγετε έναν έγκυρο κωδικό.");return}try{d("");const{data:a,error:i}=await(await D(async()=>{const{supabase:t}=await import("./index-B5-U9oIS.js").then(c=>c.I);return{supabase:t}},__vite__mapDeps([0,1]))).supabase.from("personal_training_codes").select("*").eq("code",s).eq("is_active",!0).maybeSingle();if(i||!a){d("Λάθος κωδικός πρόσβασης. Παρακαλώ δοκιμάστε ξανά.");return}if(!a.used_by&&(l!=null&&l.id)){const{error:t}=await(await D(async()=>{const{supabase:c}=await import("./index-B5-U9oIS.js").then(f=>f.I);return{supabase:c}},__vite__mapDeps([0,1]))).supabase.from("personal_training_codes").update({used_by:l.id,used_at:new Date().toISOString()}).eq("id",a.id);if(t){d("Αποτυχία δέσμευσης κωδικού. Δοκιμάστε ξανά.");return}}try{localStorage.setItem("has_personal_training","true")}catch{}h(!1),window.open("/personal-training","_blank")}catch{d("Παρουσιάστηκε σφάλμα. Δοκιμάστε ξανά.")}},A=s=>{const a=new Date(s),i=new Date,t=a.getTime()-i.getTime(),c=Math.ceil(t/(1e3*60*60*24));return Math.max(0,c)},R=(s,a)=>{const i=new Date(s),t=new Date(a),c=new Date,f=t.getTime()-i.getTime(),$=c.getTime()-i.getTime();return Math.min(100,Math.max(0,$/f*100))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Διαχείριση Συνδρομής"}),e.jsx("p",{className:"text-gray-600",children:"Διαχειριστείτε τη συνδρομή και τις πιστώσεις σας"})]}),e.jsxs("button",{onClick:()=>n(!0),className:"btn-primary flex items-center",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Αγορά Πακέτου"]})]}),r&&e.jsxs("div",{className:"card bg-gradient-to-r from-primary-50 to-primary-100 border-primary-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-primary-600 rounded-lg",children:e.jsx(j,{className:"h-8 w-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-primary-900",children:"Ενεργή Συνδρομή"}),e.jsx("p",{className:"text-primary-700",children:(C=g.find(s=>s.id===r.packageId))==null?void 0:C.name})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-primary-900",children:[r.credits," πιστώσεις"]}),e.jsx("p",{className:"text-primary-700",children:"διαθέσιμες"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex justify-between text-sm text-primary-700 mb-2",children:[e.jsx("span",{children:"Πρόοδος συνδρομής"}),e.jsxs("span",{children:[A(r.endDate)," ημέρες ακόμα"]})]}),e.jsx("div",{className:"w-full bg-primary-200 rounded-full h-2",children:e.jsx("div",{className:"bg-primary-600 h-2 rounded-full transition-all duration-300",style:{width:`${R(r.startDate,r.endDate)}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4 pt-4 border-t border-primary-200",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-primary-900",children:p(r.startDate)}),e.jsx("p",{className:"text-sm text-primary-700",children:"Ημερομηνία έναρξης"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-primary-900",children:p(r.endDate)}),e.jsx("p",{className:"text-sm text-primary-700",children:"Ημερομηνία λήξης"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold text-primary-900",children:r.autoRenew?"Ναι":"Όχι"}),e.jsx("p",{className:"text-sm text-primary-700",children:"Αυτόματη ανανέωση"})]})]})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Διαθέσιμα Πακέτα"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:g.map(s=>{const a=(r==null?void 0:r.packageId)===s.id,i=s.id==="2",t=typeof window<"u"&&localStorage.getItem("has_personal_training")==="true";return e.jsxs("div",{className:`
                  border rounded-lg p-6 relative transition-all duration-200
                  ${a?"border-primary-300 bg-primary-50":"border-gray-200 hover:border-primary-300 hover:shadow-md"}
                  ${i?"ring-2 ring-primary-500":""}
                `,children:[i&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsx("span",{className:"bg-primary-600 text-white text-xs font-medium px-3 py-1 rounded-full",children:"Προτεινόμενο"})}),a&&e.jsx("div",{className:"absolute -top-3 right-4",children:e.jsxs("span",{className:"bg-green-600 text-white text-xs font-medium px-3 py-1 rounded-full flex items-center",children:[e.jsx(S,{className:"h-3 w-3 mr-1"}),"Ενεργό"]})}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:s.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:s.description}),e.jsx("div",{className:"text-3xl font-bold text-primary-600 mb-1",children:o(s.price)}),e.jsx("p",{className:"text-gray-500 text-sm",children:"ανά μήνα"})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Πιστώσεις:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.credits===0?"Απεριόριστο":s.credits})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Διάρκεια:"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[s.validityDays," ημέρες"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Κόστος/μάθημα:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:s.credits===0?"Απεριόριστο":o(s.price/s.credits)})]})]}),e.jsx("button",{onClick:()=>{s.id==="3"?t||E():M(s.id)},disabled:a||s.id==="3"&&t,className:`
                    w-full py-3 px-4 rounded-lg font-medium transition-colors
                    ${a?"bg-gray-200 text-gray-500 cursor-not-allowed":s.id==="3"?t?"bg-green-100 text-green-700 border border-green-300 cursor-not-allowed":"bg-gradient-to-r from-purple-600 to-purple-700 text-white hover:from-purple-700 hover:to-purple-800":"btn-primary hover:bg-primary-700"}
                  `,children:a?"Τρέχον Πακέτο":s.id==="3"?t?"✅ Είστε Εγγεγραμμένος":"🔒 Πρόσβαση με Κωδικό":"Επιλογή Πακέτου"}),s.id==="3"&&t&&e.jsxs("div",{className:"mt-3 flex items-center justify-center text-green-700 bg-green-50 border border-green-200 rounded-md py-2 text-sm",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Η πρόσβαση στο Personal Training είναι ενεργή στο προφίλ σας"]})]},s.id)})})]}),e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Ιστορικό Πληρωμών"}),e.jsx("div",{className:"space-y-3",children:w.length>0?w.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${s.status==="approved"?"bg-green-100":s.status==="pending"?"bg-yellow-100":s.status==="rejected"?"bg-red-100":"bg-gray-100"}`,children:e.jsx(j,{className:`h-5 w-5 ${s.status==="approved"?"text-green-600":s.status==="pending"?"text-yellow-600":s.status==="rejected"?"text-red-600":"text-gray-600"}`})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900",children:[o(s.amount)," - ",s.paymentMethod]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[p(s.createdAt)," • ",P(s.status)]}),s.transactionId&&e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",s.transactionId]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`badge ${s.status==="approved"?"badge-success":s.status==="pending"?"badge-warning":s.status==="rejected"?"badge-error":"badge-info"}`,children:P(s.status)}),s.status==="pending"&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Λήγει ",p(s.expiresAt)]})]})]},s.id)):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(j,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{children:"Δεν έχετε ιστορικό πληρωμών"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg inline-block mb-3",children:e.jsx(L,{className:"h-6 w-6 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:N.totalBookings}),e.jsx("p",{className:"text-gray-600",children:"Συνολικές κρατήσεις"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg inline-block mb-3",children:e.jsx(Z,{className:"h-6 w-6 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:N.referralRewards}),e.jsx("p",{className:"text-gray-600",children:"Πιστώσεις παραπομπών"})]}),e.jsxs("div",{className:"card text-center",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg inline-block mb-3",children:e.jsx(K,{className:"h-6 w-6 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:N.availableCredits}),e.jsx("p",{className:"text-gray-600",children:"Διαθέσιμες πιστώσεις"})]})]}),T&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Αγορά Πακέτου"}),e.jsx("button",{onClick:()=>n(!1),className:"text-gray-400 hover:text-gray-600",children:"×"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Επιλέξτε πακέτο"}),e.jsxs("select",{className:"input-field",value:x||"",onChange:s=>u(s.target.value),children:[e.jsx("option",{value:"",children:"Επιλέξτε πακέτο"}),g.map(s=>e.jsxs("option",{value:s.id,children:[s.name," - ",o(s.price)," (",s.credits===0?"Απεριόριστο":s.credits," πιστώσεις)"]},s.id))]})]}),x&&e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg",children:(()=>{const s=g.find(a=>a.id===x);return s?e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Πακέτο:"}),e.jsx("span",{className:"font-medium",children:s.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Πιστώσεις:"}),e.jsx("span",{className:"font-medium",children:s.credits===0?"Απεριόριστο":s.credits})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Διάρκεια:"}),e.jsxs("span",{className:"font-medium",children:[s.validityDays," ημέρες"]})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-lg border-t pt-2",children:[e.jsx("span",{children:"Σύνολο:"}),e.jsx("span",{className:"text-primary-600",children:o(s.price)})]})]}):null})()})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>n(!1),className:"btn-secondary flex-1",children:"Ακύρωση"}),e.jsx("button",{onClick:k,disabled:!x,className:"btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:"Επιβεβαίωση Αγοράς"})]})]})}),I&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Πρόσβαση σε Personal Training / Kick Boxing"}),e.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600",children:"×"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-purple-600"})}),e.jsx("h4",{className:"font-semibold text-purple-900",children:"Εξαιρετικό Πακέτο"})]}),e.jsx("p",{className:"text-sm text-purple-700",children:"Αυτό το πακέτο περιλαμβάνει Personal Training και Kick Boxing μαθήματα με εξειδικευμένους προπονητές."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Κωδικός Πρόσβασης"}),e.jsx("input",{type:"password",className:"input-field",placeholder:"Εισάγετε τον κωδικό πρόσβασης",value:b,onChange:s=>{y(s.target.value),d("")},onKeyPress:s=>{s.key==="Enter"&&_()}}),v&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:v})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Σημείωση:"})," Αυτό το πακέτο απαιτεί ειδικό κωδικό πρόσβασης. Επικοινωνήστε με τη διαχείριση για να λάβετε τον κωδικό σας."]})})]}),e.jsxs("div",{className:"flex space-x-3 mt-6",children:[e.jsx("button",{onClick:()=>h(!1),className:"btn-secondary flex-1",children:"Ακύρωση"}),e.jsx("button",{onClick:_,disabled:!b.trim(),className:"btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:"Επιβεβαίωση"})]})]})})]})};export{Q as default};
